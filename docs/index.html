<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Design of single- and multi-stage multi-arm clinical trials • multiarm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Design of single- and multi-stage multi-arm clinical trials">
<meta property="og:description" content="multiarm provides functions to assist with the design of
    single- and multi-stage multi-arm clinical trials. In both cases the
    available functions allow for sample size determination, trial simulation,
    analytical operating characteristic calculation, and the production of
    several informative plots. An R Shiny graphical user interface is also
    provided to aid design determination. Further details on single-stage design
    can be found in Grayling and Wason (2020) &lt;doi:10.1186/s12885-020-6525-0&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">multiarm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.12.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/single_stage.html">Single-stage multi-arm clinical trials</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/mjg211/multiarm/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="multiarm-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#multiarm-" class="anchor"></a>multiarm <img src="reference/figures/multiarm.png" align="right" height="139">
</h1></div>

<div id="description" class="section level2">
<h2 class="hasAnchor">
<a href="#description" class="anchor"></a>Description</h2>
<p><code>multiarm</code> provides functions to assist with the design of single- and multi-stage multi-arm clinical trials. In either case the available functions allow for sample size determination, trial simulation, analytical operating characteristic calculation, and the production of several informative plots.</p>
<p>Note that an R Shiny graphical user interface is also available for designing single-stage trials; it can be accessed within R using <code><a href="reference/gui.html">multiarm::gui()</a></code>, or online at <a href="https://mjgrayling.shinyapps.io/multiarm" class="uri">https://mjgrayling.shinyapps.io/multiarm</a>. Additional information on this app can be found in <a href="https://doi.org/10.1186/s12885-020-6525-0">Grayling and Wason (2020)</a>.</p>
</div>
<div id="getting-started" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h2>
<p>You can install the latest development version of <code>multiarm</code> from <a href="https://github.com/">Github</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw">devtools</span>::<span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"mjg211/multiarm"</span>)
</pre></div>
<p>An introductory example of how to make use of some of the package’s core functionality can be found below. More detailed support, for single-stage designs, is available in the package vignette, which can be accessed with <code><a href="articles/single_stage.html">vignette("single_stage", package = "multiarm")</a></code>. See also <a href="https://doi.org/10.1186/s12885-020-6525-0">Grayling and Wason (2020)</a>. For further help, please email <a href="mailto:michael.grayling@newcastle.ac.uk" class="email">michael.grayling@newcastle.ac.uk</a>.</p>
</div>
<div id="details" class="section level2">
<h2 class="hasAnchor">
<a href="#details" class="anchor"></a>Details</h2>
<p>In total, 46 functions are currently available. Their naming conventions are such that several character strings are joined together, separated by underscores. The first string indicates the purpose of the function (i.e., what type of calculation it performs):</p>
<ul>
<li>
<code>build_###_###()</code>: Build multi-arm clinical trial design objects, like those returned by the <code>des_###_###()</code> functions. For use when a specific design is of interest.</li>
<li>
<code>des_###_###()</code>: Determine the sample size required by a particular type of multi-arm clinical trial design.</li>
<li>
<code><a href="reference/gui.html">gui()</a></code>: Provides a graphical user interface to design determination.</li>
<li>
<code>opchar_###_###()</code>: Determine the operating characteristics (power, family-wise error-rates, etc.) of a supplied multi-arm clinical trial design, via multivariate normal integration.</li>
<li>
<code>plot.multiarm_des_###_###()</code>: Produce informative plots (power, false discovery rate curves, etc.) relating to a supplied multi-arm clinical trial design.</li>
<li>
<code>sim_###_###()</code>: Empirically estimate the operating characteristics (power, family-wise error-rates, etc.) of a supplied multi-arm clinical trial design, via simulation.</li>
</ul>
<p>The second indicates the design:</p>
<ul>
<li>
<code>###_dtl_###()</code>: Relate to multi-stage drop-the-losers designs. See, e.g., <a href="https://doi.org/10.1177/0962280214550759">Wason <em>et al</em> (2017)</a>.</li>
<li>
<code>###_gs_###()</code>: Relate to group-sequential multi-arm multi-stage designs. See, e.g., <a href="https://doi.org/10.1093/biomet/ass002">Magirr <em>et al</em> (2012)</a>.</li>
<li>
<code>###_ss_###()</code>: Relate to single-stage designs. See, e.g., <a href="https://doi.org/10.1186/s12885-020-6525-0">Grayling and Wason (2020)</a>.</li>
</ul>
<p>The third indicates what type of outcome the function is for:</p>
<ul>
<li>
<code>###_###_bern()</code>: Assume a Bernoulli distributed primary outcome.</li>
<li>
<code>###_###_norm()</code>: Assume a normally distributed primary outcome.</li>
<li>
<code>###_###_pois()</code>: Assume a Poisson distributed primary outcome.</li>
</ul>
</div>
<div id="example-single-stage-design-for-a-normally-distributed-outcome" class="section level2">
<h2 class="hasAnchor">
<a href="#example-single-stage-design-for-a-normally-distributed-outcome" class="anchor"></a>Example: Single-stage design for a normally distributed outcome</h2>
<p>Typically, a <code>des_###_###()</code> function would be used first to identify a design for the trial parameters of interest. For example, consider designing a single-stage trial for:</p>
<ul>
<li>Three experimental treatment arms (see <code>K</code>).</li>
<li>Desiring a family-wise error-rate of at most 5%, controlling using Dunnett’s correction (see <code>alpha</code> and <code>correction</code>).</li>
<li>Desiring marginal power to reject each null hypothesis of 80% for a clinically relevant difference of 1 (see <code>beta</code>, <code>delta1</code>, and <code>power</code>).</li>
<li>Assuming the standard deviation of all responses is 1 (see <code>sigma</code>).</li>
<li>Allocating patients equally to each arm (see <code>ratio</code>).</li>
</ul>
<p>To compute the design, we would run:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">des</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/des_ss_norm.html">des_ss_norm</a></span>(K          = <span class="fl">3</span>,
                   alpha      = <span class="fl">0.05</span>,
                   beta       = <span class="fl">0.2</span>,
                   delta1     = <span class="fl">1</span>,
                   sigma      = <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="fl">4</span>),
                   ratio      = <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="fl">3</span>),
                   correction = <span class="st">"dunnett"</span>,
                   power      = <span class="st">"marginal"</span>)
</pre></div>
<p>Then, the total required sample size is:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">des</span><span class="op">$</span><span class="kw">N</span>
<span class="co">#&gt; [1] 67.42534</span>
</pre></div>
<p>In addition, the operating characteristics under the <em>global null</em>, <em>global alternative</em>, and each of the <em>least favourable configurations</em>, can be accessed with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">des</span><span class="op">$</span><span class="kw">opchar</span>
<span class="co">#&gt; # A tibble: 5 x 20</span>
<span class="co">#&gt;    tau1  tau2  tau3   Pdis    Pcon     P1     P2     P3 FWERI1  FWERI2  FWERI3</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1     0     0     0 0.0501 0.00109 0.0196 0.0196 0.0196 0.0501 0.00774 0.00109</span>
<span class="co">#&gt; 2     1     1     1 0.950  0.611   0.800  0.800  0.800  0      0       0      </span>
<span class="co">#&gt; 3     1     0     0 0.800  0.00330 0.800  0.0196 0.0196 0.0360 0.00330 0      </span>
<span class="co">#&gt; 4     0     1     0 0.800  0.00330 0.0196 0.800  0.0196 0.0360 0.00330 0      </span>
<span class="co">#&gt; 5     0     0     1 0.800  0.00329 0.0196 0.0196 0.800  0.0360 0.00330 0      </span>
<span class="co">#&gt; # … with 9 more variables: FWERII1 &lt;dbl&gt;, FWERII2 &lt;dbl&gt;, FWERII3 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   PHER &lt;dbl&gt;, FDR &lt;dbl&gt;, pFDR &lt;dbl&gt;, FNDR &lt;dbl&gt;, Sens &lt;dbl&gt;, Spec &lt;dbl&gt;</span>
</pre></div>
<p>Useful plots can also be produced with <code><a href="reference/plot.multiarm_des_ss_norm.html">plot.multiarm_des_ss_norm()</a></code> as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">des</span>)
</pre></div>
<p><img src="reference/figures/README-plot-1.png" width="100%"><img src="reference/figures/README-plot-2.png" width="100%"><img src="reference/figures/README-plot-3.png" width="100%"><img src="reference/figures/README-plot-4.png" width="100%"></p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Grayling MJ, Wason JMS (2020) A web application for the design of multi-arm clinical trials. <em>BMC Cancer</em> 20:80. DOI: <a href="https://doi.org/10.1186/s12885-020-6525-0">10.1186/s12885-020-6525-0</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/32005187">32005187</a>.</p>
<p>Magirr D, Jaki T, Whitehead J (2012) A generalized Dunnett test for multi-arm multi-stage clinical studies with treatment selection. <em>Biometrika</em> 99(2):494–501. DOI: <a href="https://doi.org/10.1093/biomet/ass002">10.1093/biomet/ass002</a>.</p>
<p>Wason J, Stallard N, Bowden J, Jennison C (2017) A multi-stage drop-the-losers design for multi-arm clinical trials. <em>Stat Meth Med Res</em> 26(1):508–524. DOI: <a href="https://doi.org/10.1177/0962280214550759">10.1177/0962280214550759</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/25228636">25228636</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="http://github.com/mjg211/multiarm/">http://​github.com/​mjg211/​multiarm/​</a>
</li>
<li>Report a bug at <br><a href="http://github.com/mjg211/multiarm/issues">http://​github.com/​mjg211/​multiarm/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing multiarm</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Michael J Grayling <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mjg211/multiarm"><img src="https://img.shields.io/badge/devel%20version-0.12.0-blue.svg"></a></li>
<li><a href="https://github.com/mjg211/multiarm"><img src="https://img.shields.io/github/languages/code-size/mjg211/multiarm.svg"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Michael J Grayling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
